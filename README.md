# 信贷风险预测模型

## 1. 项目简介
本项目基于贷款基础表和银行交易流水表，通过多维度特征工程和机器学习方法，构建用于信贷风险预测的模型。模型核心优势在于：  

- 综合客户基本信息、交易流水及行为模式，提取高维度特征；  
- 引入交易时间衰减、行为异常检测和交易序列等高级特征；  
- 使用 AutoGluon 提供的自动化模型训练和集成方法，实现高效预测。

---

## 2. 数据预处理

### 2.1 基础表处理
- **时间字段转换**：将时间戳字段 (`issue_time`, `record_time`, `history_time`) 转为 `datetime` 类型。  
- **类别特征处理**：对重要类别特征 (`residence`, `title`, `career`, `zip_code`) 保留字符串形式；其他特征使用 LabelEncoder。  
- **时间衍生特征**：提取年份、月份、季度及周期性编码（正弦/余弦）。  
- **数值特征加工**：包括贷款与分期比率、账户余额比率、交互特征、多项式特征等。  
- **风险 Proxy 特征**：如高利率贷款标记、长期贷款标记、账户余额异常标记等。  

### 2.2 银行流水特征
- **基础聚合特征**：收入、支出总额、均值、标准差、最大值及交易次数。  
- **时间分布特征**：每日交易活跃度、最大交易额及日交易波动。  
- **交易间隔特征**：计算交易间隔均值和标准差。  
- **窗口特征**：对不同时间窗口（如 7/15/30/60/90 天）进行前后交易特征聚合。  
- **金额规律特征**：金额是否整数、千位数规律及小额支出比例。  
- **集聚度/高频特征**：日交易集中度 (HHI) 和最大日交易额。  
- **时间段特征**：夜间、白天、晚间交易次数统计。  

### 2.3 交易频率与规律性特征
- 每用户交易总次数、活跃天数、日均交易次数。  
- 日期规律性、交易间隔均值/标准差/变异系数。  
- 交易时间偏好（早/中/晚/夜）及周末交易比例。  

### 2.4 时间衰减加权特征
- 根据交易距离贷款发放日期天数，计算衰减权重。  
- 提取加权资金流、近期活动强度、交易频率及交易金额稳定性。  

### 2.5 行为异常检测特征
- 金额异常（偏度、峰度、异常值比例）、时间异常及行为波动。  
- 紧急交易检测：短时间内大额交易占比。  
- 非工作时间交易比例。  

### 2.6 交易序列特征
- 将发放前交易序列按金额分桶生成 token 序列。  
- TF-IDF 特征向量化，并使用 SVD 降维，提取序列模式。  

### 2.7 业务特征
- 偿债能力指标（债务覆盖率、可支配收入）。  
- 流动性指标（可支撑天数）。  
- 收入增长率、交易趋势等。  

### 2.8 比例/差值/活跃度特征
- 贷款与收入、支出、交易额的比例特征。  
- 窗口趋势特征（前后 30 天交易变化率）。  
- 分布特征（最大/最小/范围/变异系数）。

---

## 3. 使用的算法模型


### 3.1 AutoGluon
- 自动化机器学习框架，支持多模型融合、超参数调优和特征处理。  
- 优点：减少人工调参工作，提升模型泛化能力。  

---

## 4. 模型实现流程

### 4.1 数据准备
```python
import pandas as pd
df_loan = pd.read_csv('train.csv')
df_bank = pd.read_csv('train_bank_statement.csv')
df_test_loan = pd.read_csv('testab.csv')
df_test_bank = pd.read_csv('testab_bank_statement.csv')

